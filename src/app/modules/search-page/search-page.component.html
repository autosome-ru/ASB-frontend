<div class="container flex-grow-1 mx-md-auto mx-sm-0 pb-3 px-sm-0 px-md-auto">

    <asb-search [width]="'full'"></asb-search>

    <hr class="v-divider" style="margin:0">
    <div style="background: #f8f8f8;" class="d-flex">
        <div class="container-fluid mx-auto" style="padding-bottom: 5px; padding-top: 5px">
            <div class="flex text-xs-right xs-12">
                <div class="text-xs-left">
                    <h4 class="headline text--bold-300 search-page__text">
                        {{getPhrase((searchSnpResults$ | async).length,
                        (searchSnpResultsLoading$ | async))}}

                        <mat-button-toggle-group #group="matButtonToggleGroup" value="card">
                            <mat-button-toggle
                                value="card"
                                matTooltip="card view"
                            >
                                <mat-icon svgIcon="list"></mat-icon>
                            </mat-button-toggle>

                            <mat-button-toggle
                                value="list"
                                matTooltip="table view"
                            >
                                <mat-icon svgIcon="list"></mat-icon>
                            </mat-button-toggle>
                        </mat-button-toggle-group>
                    </h4>


                </div>
            </div>
            <ng-container *ngIf="!(searchSnpResultsLoading$ | async); else loadingTemplate">
                <ng-container *ngIf="group.value === 'card'; else tableViewTemplate">
                    <div class="layout pb-2"
                         *ngFor="let snp of searchSnpResults$ | async">
                        <mat-card
                            class="search-page__card"
                            asbElevation
                            role="group"
                            (click)="_navigateToSnp({rsId: snp.rsId, alt: snp.altBase})"

                        >
                            <mat-card-header class="layout border--radius-top-8 row wrap theme--dark">
                                <mat-card-title>
                                    <asb-snp-header
                                        [data]="snp"
                                        [snpCard]="false"
                                    >
                                    </asb-snp-header>
                                </mat-card-title>
                                <mat-card-subtitle>

                                </mat-card-subtitle>
                            </mat-card-header>
                            <mat-card-content>
                                <asb-snp-card
                                    [snpData]="snp"
                                    [noButtons]="true"
                                >
                                </asb-snp-card>
                            </mat-card-content>
                        </mat-card>
                    </div>
                </ng-container>
            </ng-container>
        </div>
    </div>
</div>

<ng-template #loadingTemplate>
    <div style="height: 294px">
        <div class="search-page__spinner">
            <mat-progress-spinner mode="indeterminate" color="accent" [diameter]="120"></mat-progress-spinner>
        </div>
    </div>
</ng-template>

<ng-template #manyValuesViewTemplate let-value="value">
    <span *ngFor="let object of value; let last=last; let i=index">
        <span *ngIf="i < 5">
            {{object?.name}}<span *ngIf="!last && i !== 4">;&nbsp;</span>
        </span>
        <span *ngIf="i==6">...</span>
    </span>
</ng-template>

<ng-template #tableViewTemplate>
    <div class="layout">
        <asb-table
            #tableView
            [displayedColumns]="displayedColumns"
            [data]="searchSnpResults$ | async"
            [columnModel]="columnModel"
            [clickableRow]="true"
            (rowClickEmitter)="_handleTableRowClick($event)"
        >
        </asb-table>
    </div>
</ng-template>


