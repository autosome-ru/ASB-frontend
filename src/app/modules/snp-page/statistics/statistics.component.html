<ng-content></ng-content>
<div class="container-fluid px-0 px-sm-2"
     style="padding-top: 5px;"
>
    <div class="row" *ngIf="objectData.length > 0">
        <form [formGroup]="tableFormGroup" class="container">
            <div style="margin-bottom: 10px">
                <mat-form-field>
                    <mat-label>Selected columns</mat-label>
                    <mat-select formControlName="columns"
                                multiple
                                (selectionChange)="_changeColumns($event)"
                    >
                        <mat-select-trigger>
                            {{tableFormGroup.get('columns').value ?
                            tableColumnModel[tableFormGroup.get('columns').value[0]]?.view : ''}}
                            <span *ngIf="tableFormGroup.get('columns').value?.length > 1"
                                  class="snp-page__additional-selection"
                            >
                                (+{{tableFormGroup.get('columns').value?.length - 1}}
                                {{tableFormGroup.get('columns').value?.length === 2 ? 'other' : 'others'}})
                            </span>
                        </mat-select-trigger>
                        <mat-option
                            *ngFor="let column of nonStickyColumnModel | keyvalue: originalOrder"
                            [value]="column.key"
                        >
                            {{column.value.view}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
                <div style="display: flex; justify-content: flex-start; flex-wrap: wrap">
                    <mat-form-field style="margin-left: 5px; margin-right: 5px; width:180px">
                        <input
                            placeholder="Filter"
                            matInput
                            type="text"
                            formControlName="filter"
                        >
                        <button
                            type="submit"
                            style="display:none"
                            (click)="_applyFilter()"
                        >
                            hidden submit
                        </button>
                        <button
                            mat-icon-button
                            [hidden]="!tableFormGroup.get('filter').value"
                            style="margin-left: 5px"
                            matSuffix
                            (click)="_clearFilterField()"
                        >
                            <mat-icon svgIcon="clear"></mat-icon>
                        </button>
                    </mat-form-field>
                    <div>
                        <button
                            mat-raised-button
                            style="margin-right: 5px"
                            (click)="_applyFilter()"
                            color="primary"
                        >
                            Apply filter
                        </button>
                        <button
                            style="margin-right: 5px"
                            mat-raised-button
                            (click)="_resetFilters()"
                        >
                            Reset
                        </button>
                    </div>
                    <div>
                        <button
                            mat-raised-button
                            (click)="_getSnpInfoCsv()"
                        >
                            Get TSV
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <div class="snp-page__table-elevation">
        <asb-table
            #tableViewTFCL
            [columnModel]="tableColumnModel"
            [displayedColumns]="tableDisplayedColumns"
            [data]="filteredObjectData"
            [popoverContentTemplate]="popoverContentTemplate"
            [getTitle]="snpName"
            [paginatorOptions]="_getPaginatorOptions()"
            [colorStyle]="_calculateColor"
        >
        </asb-table>
    </div>
</div>

<ng-template #popoverContentTemplate let-row="row">
    <asb-inner-table
        [innerTableData]="row ? row.expSnps : []"
    ></asb-inner-table>
</ng-template>
